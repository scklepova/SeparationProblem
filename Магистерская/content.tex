\sectionwithoutnumber{ВВЕДЕНИЕ}

Задача о различении двух наборов входных данных - одна из самых простых вычислительных задач, которые можно себе представить. Обычно, входные данные представлены в виде двух строк $u$ и $v$ над конечным алфавитом $\Sigma$ и известны заранее. 

В мощной вычислительной модели, такой как RAM, задача решается за константную память (помимо памяти, занимаемой строками): нам достаточно одного регистра для того, чтобы найти позицию, в которой различаются $u$ и $v$. 

Однако для более слабой модели, например, для конечных автоматов, задача существенно усложняется, и ее уже нельзя решить за константую память. Задача об определении минимального размера конечного автомата, различающего два данных слова, NP-трудна. Более того, не всё известно об асимптотике минимального количества вершин, необходимого, чтобы построить различающий автомат для каждой пары слов, длина которых меньше либо равна заданному наперед числу. Это и есть задача о различении слов автоматами, и на данный момент известны только верхняя и нижняя границы искомой функции, между которыми довольно большой разрыв.

Далее в работе будут даны все необходимые определения, задача будет поставлена более формально, также будет показана эквивалентность этой задачи поиску тождеств в полгруппе преобразований и группе перестановок. Более того, будут приведены серии тождеств, одна из которых позволяет слегка поднять нижнюю границу искомой функции. 

\newpage
\section{Основные определения и постановка задачи}

\subsection{Основные определения}
Пусть $\mathscr{A} = (\Sigma, Q, \delta, s, T)$ – детерминированный конечный автомат, где 
\\ $\Sigma$ – входной алфавит, из которого формируются слова, принимаемые автоматом, $\Sigma \ne \emptyset$,
\\ Q – множество состояний автомата, $Q \ne \emptyset$,
\\ $\delta$ – функция переходов, определенная как отображение $\delta: Q \times \Sigma \rightarrow Q$, 
\\ s – начальное состояние, $s \in Q$
\\ T – множество терминальных (конечных) состояний, $T \subseteq Q$.

\begin{definition}
	Автомат принимает слово, если по окончании его обработки он находится в терминальном состоянии.
\end{definition}
\begin{definition}
	Пусть $u$ и $v$ – слова над алфавитом $\Sigma$. Говорят, что автомат различает слова $u$ и $v$, если он принимает одно из них и не принимает другое. 
\end{definition}

\begin{example}
	Автомат на рисунке \ref{automaton_example} различает слова 0010 и 1000.
\end{example}

\image{example.png}{}\label{automaton_example}

\begin{definition}
	Пару слов $(u, v)$ будем называть тождеством для некоторого автомата, если он либо принимает и $u$, и $v$, либо отвергает и $u$, и $v$, то есть не различает их.
\end{definition}

Однако, в дальнейшем нам будет удобнее будет считать терминальными все состояния у рассматриваемых автоматов, и в связи с этим подкорректировать определения.

\begin{definition}
	Автомат различает слова $u$ и $v$, если он заканчивает их чтение в разных состояниях, то есть $s.u \ne s.v$. 
\end{definition}

Поскольку вся работа посвящена перестановочным автоматам, необходимо дать и это ключевое определение.
\begin{definition} 
	Автомат $\mathscr{A}$ – перестановочный, если переход из любого состояния по любому символу является перестановкой состояний, или, что тоже самое, для любого символа $x$ из $\Sigma$ и любых состояний $q$ и $p$ $\delta(q, x) \ne \delta(p, x)$.
\end{definition}

И также в работе часто будет встречаться понятие порядка перестановки, определение которого тоже стоит напомнить.
\begin{definition}
	Порядком перестановки называется наименьшее общее кратное длин циклов, из объединения которых состоит перестановка.
\end{definition}

\subsection{Постановка задачи}
 
Обозначим за $sep(u, v)$ количество состояний в минимальном детерминированном конечном автомате, различающем $u$ и $v$, за $sep_p(u, v)$ – количество состояний в перестановочном автомате, различающем $u$ и $v$.

\begin{example}
	Можно проверить, что ни один автомат из двух состояний не сможет различить слова 0010 и 1000, а как мы видели из рисунка \ref{automaton_example}, существует автомат с тремя состояниями, различающий эту пару. Значит, $sep(0010, 1000) = 3$.
\end{example}

Обозначим
$$
	S(n) = \max_{u \ne v; |u|, |v| \le n} sep(u, v)
$$ 
и
$$
	S_p(n) = \max_{u \ne v; |u|, |v| \le n} sep_p(u, v)
$$
Задача о различении слов автоматами, известная как Separating Words Problem, состоит в том, чтобы найти хорошую асимптотическую оценку функций $S(n)$ и $S_p(n)$, то есть оценить, сколько состояний должно быть в автомате, различающем две строки длины $n$.

Эту задачу сформулировали Павел Горальчик и Вацлав Коубек в 1986 году \cite{on discerning, remarks on separating}. Они же доказали, что $S(n) = o(n)$. Позже этой задачей занимался Джон Робсон, который в 1989 году \cite{robson 1989} доказал, что $S(n) = O(n^{2/5}(\log n)^{3/5})$ для произвольных автоматов, и в 1996 году \cite{robson 1996} опубликовал статью, в которой было доказано, что $S_p(n) = O(n^{1/2})$.

\subsection{Сведение к поиску тождеств в полугруппах и группах}

Обозначим за $T_k$ полугруппу всех отображений множества ${1, ..., k}$ в самого себя относительно операции композиции отображений. $T_k$ называют полугруппой преобразований на $k$ элементах.
\begin{definition}
	Тождеством в полугруппе $T$ называют пару слов $(u, v)$ такую, что образы $u$ и $v$ под действием любого отображения $\Sigma \rightarrow T$ совпадают как элементы $T$. Длина тождества $(u, v)$ - максимум длин $u$ и $v$. Факт тождественности $u$ и $v$ в $T_k$ будем обозначать как $u \equiv_k v$.
\end{definition}

\begin{definition}
	Полугруппа преобразований детерминированного конечного автомата $\mathscr{A}$ - это подполугруппа $T_{|Q|}$, состоящая из всех отображений $w: q \rightarrow q.w$, где $q \in \Sigma^*$.
\end{definition}

Следующий факт соединяет между собой тождества в полугруппах и разделение слов автоматами.

\begin{fact} \label{identity separation equivalency}
	Для любой пары слов $u$, $v$, $u \equiv_k v$ $ \iff $ $S(u, v) > k$
\end{fact}

Действительно, если $u \equiv_k v$, то это тождество выполняется и для полугруппы преобразований любого конечного детерминированного автомата с $k$ состояниями, откуда получаем $q.u = q.v$ для любого состояния $q$. С другой стороны, если для некоторого отображения $\rho: \Sigma \rightarrow T_k$ $\rho(u) \ne \rho(v)$ в $T_k$, тогда преобразования $\rho(a), a \in \Sigma$ могут быть использованы для создания автомата с $k$ состояниями, отличающего $u$ от $v$.

Известно, что задача о проверке $u \equiv_k v$ принадлежит классу coNP-complete для любого $k > 2$. Поэтому исходя из Факта \ref{identity separation equivalency}, задача о проверке $S(u, v) \le k$ является NP-полной. К тому же, задача о различении слов автоматами эквивалентна поиску асимптотики минимальной длины тождества в $T_k$.

До недавнего времени самым коротким тождеством в $T_k$ было 
\begin{equation} \label{unary identity}
	x^{k-1} = x^{k-1+lcm(k)},
\end{equation} 
где $lcm(k)$ - это наименьшее общее кратное всех чисел от 1 по $k$. Однако недавно было найдено новое тождество, которое короче \ref{unary identity}, если $k$ - простое или степень простого числа \cite{lower bounds}.

Имеет место аналогичная Факту \ref{identity separation equivalency} связь различения слов перестановочными автоматами и тождеств в группе перестановок $S_k$.

\begin{fact}
	Для любой пары слов $u$, $v$, $u \equiv_k v$ в $S_k$ $ \iff $ $S_p(u, v) > k$
\end{fact}

Самое короткое тождество в $S_k$, дающее почву для нижней оценки функции $S_p(k)$ имеет вид 
$$
	x^{lcm(k)} = 1
$$
Было несколько попыток найти более короткие групповые тождества. Существование тождества длины $O(e^{\sqrt[]{n \log n}})$ было доказано в статье \cite{short group identity 1}; основная идея заключается в применении функции Ландау о максимальном порядке перестановки. Совсем недавно было также доказано существование тождества длины $O(e^{\log^4 n \log \log n})$ \cite{short group identity diameter of Caleys graph}, основанного на новых результатах о диаметре графа Кэли $S_k$. В данной работе будет представлена серия тождеств, показывающая, что $S_p(n) \ge \frac{3}{2}\log n + o(\log n)$.

\newpage
\subsection{Полезные факты}
Вставить сюда ограничения: 
	одинаковая длина слов,
	бинарный алфавит,
	начинаются и заканчиваются по-разному
	над алфавитом (xy) (yx) 

\newpage
\section{Серии тождеств}

Известно, что в группе перестановок $S_k$ есть тождество вида \ref{unary identity}  и похожее на него $x^{lcm(k)} \equiv_k y^{lcm(k)}$. Известно, что кратчайшее тождество в $S_3$ - $x^2y^2 \equiv_3 y^2x^2$, в $S_4$ - $x^6y^2xy^2 \equiv_4 y^2xy^2x^6$, представленное в \cite{remarks on separating}.

В \cite{lower bounds} было опубликовано, что кратчайшее тождество в $S_5$ и $S_6$ имеет длину 32 и выглядит так: 
\begin{equation}
	(xy)^4(yx)^5(xy)^6(yx) \equiv_6 (yx)(xy)^6(yx)^5(xy)^4
\end{equation}

Было также найдено другое тождество в $S_5$ длины 32: 
$$
	(xy)(xyyx)^3(yxxy)^2(yx)(yxxy)^2 \equiv_5 (yxxy)^2(xy)(yxxy)^2(xyyx)^3(yx),
$$
однако оно не является тождеством в $S_6$, и несколько других тождеств больших длин (см. \cite{lower bounds}), включая такое длины 34:
\begin{equation}\label{2blocks example}
	(xy)^{12}(yx)^5 \equiv_5 (yx)^5(xy)^{12}
\end{equation}
и такое длины 40:
\begin{equation} \label{3blocks example}
	(xy)^6(yx)^{10}(xy)^4 \equiv_5 (yx)^4(xy)^{10}(yx)^6.
\end{equation}

Внимательным разглядыванием найденных тождеств было установлено, что некоторые из них являются словами над алфавитом $\{xy, yx\}$, и более того, что они палиндромы над этим алфавитом. Это наблюдение дало почву для исследований тождеств, которые я назвала тождествами из $N$ блоков, где под блоком подразумевается $xy$ или $yx$.


\newpage
\subsection{Тождетсва из двух блоков}


Тождество \ref{2blocks example} является примером тождества из двух блоков, а именно: 
\begin{definition} \label{2blocks definition}
	Пара слов $(xy)^a(yx)^b$ и $(yx)^b(xy)^a$ является тождеством в $S_k$, если порядок любой перестановки из $S_k$ делит $a$ или $b$.
\end{definition}
Действительно, поскольку перестановки $xy$ и $yx$ имеют одинаковый порядок, по выбору $a$ и $b$ $(xy)^a = 1$ или $(yx)^b = 1$.

\begin{theorem}
	Длина тождества $(xy)^a(yx)^b = (yx)^b(xy)^a$ в $S_k$ составляет $e^{\frac{2}{3}k + O(\frac{k}{\log k})}$.
\end{theorem}
\begin{proof}
	Полное доказательство теоремы можно найти в \cite{lower bounds}, я лишь опишу тут идею.
	
	Пусть $m = \lfloor \alpha k \rfloor$, где $\alpha > \frac{1}{2}$ $P(m)$ - произведение всех простых и степеней простых в диапазоне $\{m+1, ..., k\}$. Положим $a = \lcm(m)$, $b = \lcm(k-m) P(m)$. Если все циклы перестановки меньше $m$, порядок такой перестановки покрывается коэффициентом $a$. Если один из циклов больше либо равен $m$, остальные циклы меньше либо равны $k-m$, и такой случай покрывается выбором $b$. Оценив асимптотически коэффициенты, и найдя минимум суммы $a$ и $b$, получим $\alpha = 2/3$ и $a+b = e^{\frac{2}{3}k + O(\frac{k}{\log k})}$.
\end{proof}
\begin{corollary}
	$S_p(n) \ge \frac{3}{2} \log n + O (\frac{\log n}{\log \log n})$.
\end{corollary}
 
 Однако, в \cite{lower bounds} не было доказано, что не существует других тождеств из двух блоков, которые не подчиняются указанному в определении \ref{2blocks definition} утверждению. Поэтому приведем здесь теорему о его необходимости, но сначала докажем вспомогательные леммы.
 
 \begin{lemma} \label{2blocks div 2}
 	Если $(xy)^a(yx)^b \equiv_k (yx)^b(xy)^a$, где $k \ge 3$, то $a$ или $b$ делится на 2.
 \end{lemma}
\begin{proof}
	От противного. Пусть $a \equiv_2 b \equiv_2 1$. Тогда автомат на Рисунке \ref{fig:2blocks_div_2} c начальным состоянием 0 различит рассматриваемую пару слов.
	\scalingimage{2blocks_div_2}{0.5}{}
	Действительно, при чтении $(xy)^a(yx)^b$ автомат в состоянии 1, а при чтении $(yx)^b(xy)^a$ - в состоянии 2.
\end{proof}
 
  \begin{lemma} \label{2blocks div 3}
 	Если $(xy)^a(yx)^b \equiv_k (yx)^b(xy)^a$, где $k \ge 4$, то $a$ или $b$ делится на 3.
 \end{lemma}
 \begin{proof}
 	От противного. Пусть ни $a$, ни $b$ не делятся на 3. Тогда автомат на Рисунке \ref{fig:2blocks_div_3} c начальным состоянием 0 различит рассматриваемую пару слов.
 	\scalingimage{2blocks_div_3}{0.5}{}
 	Возможны несколько вариантов для $a$ и $b$:
 	\begin{enumerate}
 		\item $a \equiv_3 b \equiv_3 1$. Тогда чтение первого слова автомат закончит в состоянии 3, а второго - в состоянии 2.
 		\item $a \equiv_3 b \equiv_3 2$. Тогда чтение первого слова автомат закончит в состоянии 2, а второго - в состоянии 3, в обоих случаях попав в петлю во второй перестановке.
 		\item $a \equiv_3 1$, $b \equiv_3 2$. Тогда $0.(xy)^a(yx)^b = 0$, $0.(yx)^b(xy)^a = 3$, поскольку во втором случае автомат попадает в петлю.
 		\item $a \equiv_3 2$, $b \equiv_3 1$. Тогда $0.(xy)^a(yx)^b = 2$, $0.(yx)^b(xy)^a = 0$, поскольку в первом случае автомат попадает в петлю.
 	\end{enumerate}
 	Таким образом, мы пришли к противоречию. 
 \end{proof}
 
 \begin{lemma} \label{2blocks div 4}
 	Если $(xy)^a(yx)^b \equiv_k (yx)^b(xy)^a$, где $k \ge 5$, то $a$ или $b$ делится на 4.
 \end{lemma}
 \begin{proof}
 	От противного. Пусть ни $a$, ни $b$ не делятся на 4. Рассмотрим два варианта.
 	\begin{enumerate}
 		\item $a \not \equiv_4 b$
 		\scalingimage{2blocks_div_4}{0.5}{}
 		Рассмотрим автомат с пятью состояниями и начальным состоянием 0, подобный тому, что изображен на рисунке \ref{fig:2blocks_div_4}. Поскольку $a \not \equiv_4 b$, одно из этих  состояний можно изолировать от четырех остальных. Тогда при чтении $(xy)^a$ автомат окажется в состоянии с номером $a \mod 4$, и во второй перестановке попадет в петлю. Аналогично при чтении $(yx)^b$.
 		
 		\item $a \equiv_4 b$
 		\scalingimage{2blocks_div_4_a_is_b}{0.5}{}
 		Рассмотрим автомат с пятью состояниями, где перестановка $xy$ и $yx$ - циклы из 4 состояний и одна петля, в первом случае - 4, во втором - $a$. В циклах вершины расположены по возрастанию. Начальное состояние автомата - 0. Подобный автомат можно увидеть на Рисунке \ref{fig:2blocks_div_4_a_is_b}.
 		
 		При чтении слова  $(xy)^a(yx)^b$ автомат очевидно попадает в состояние $a$. При чтении $(yx)^b(xy)^a$ автомат сначала попадет в вершину с номером $b+1$ (поскольку мы убрали из цикла вершину с номером $a \equiv_4 b$), а затем прибавит $a$ и остановится в состоянии $2a+1 \mod 4$. Если $a \not \equiv_4 3$, тогда $2a+1 \not \equiv_4 a$. В случае, когда $a \equiv_4 3$ чтение второго слова закончится в петле с номером 4. 
 	\end{enumerate}
 	И мы снова пришли к противоречию.
 \end{proof}

\begin{lemma}\label{2blocks div k}
	Если $(xy)^a(yx)^b \equiv_k (yx)^b(xy)^a$, где $k \ge 5$, то $a$ или $b$ делится на $k$.
\end{lemma}
\begin{proof}
	Снова пойдем от противного и предположим, что ни $a$, ни $b$ не делятся на $k$. Рассмотрим два варианта.
	\begin{enumerate}
		\item $a \not \equiv_k b$
		Пусть $0 < p <k$ такое, что $p \not \equiv_k a$, $p \not \equiv_k b$, $p \not \equiv_k a+b$.
		Рассмотрим автомат $\mathscr{A}$ из $k$ состояний над алфавитом $\{xy, yx\}$ с начальным состоянием 0, перестановки которого - это циклические перестановки с шагом 1, и в $xy$ поменяли местами вершины $a \mod k$ и $p$ (см. Рисунок \ref{fig:cycle_a_p}). Поскольку в нашем автомате как минимум 5 состояний, такое $p$ существует. 
		\scalingimage{cycle_a_p}{0.5}{Перестановка $xy$ автомата $\mathscr{A}$}.
		
		При чтении $(xy)^a(yx)^b$ получим $0.(xy)^a = p$, по выбору цикла $xy$, и $p.(yx)^b = p+b$.
		При чтении $(yx)^b(xy)^a$ - $0.(yx)^b = b$, $b.(xy)^a = a+b$. По выбору $p$ во втором случае автомат не попал в "ловушку", и $p+b \not \equiv_k a+b$.
		То есть рассмотренный автомат различил пару слов, которая являлась тождеством.
		
		\item $a \equiv_k b$
		\scalingimage{2blocks_div_k_a_is_b}{0.5}{Перестановки автомата $\mathscr{B}$}
		Рассмотрим числа $p \ne q$, $0 < p, q, < k$ такие, что ни одно из них не равно $-a$ и не равно $-2a$. Поскольку $k \ge 5$, такие числа найдутся.
		
		Теперь рассмотрим автомат $\mathscr{B}$ над алфавитом $\{xy, yx\}$ с начальным состоянием 0, перестановки которого - это циклические перестановки с шагом 1, где в $xy$ поменяли местами 0 и $p$, а в $yx$ - 0 и $q$ (см. Рисунок \ref{fig:2blocks_div_k_a_is_b}).
		Тогда при чтении слов автомат не попадет в поставленные ловушки (так как мы аккуратно выбрали $p$ и $q$), но начнет читать первое слово в состоянии с номером $p$ в цикле, а второе - с номером $q$. Соответственно, $\mathscr{B}$ закончит читать первое слово в состоянии $p+2a$, а второе - в $q + 2a$. Состояния не совпадают в силу неравенства $p$ и $q$, а значит мы снова пришли к противоречию.
	\end{enumerate}
\end{proof}
 
 \begin{theorem} \label{2blocks div ord}
 	Если $(xy)^a(yx)^b$ и $(yx)^b(xy)^a$ является тождеством в $S_k$, то порядок любой перестановки из $S_k$ делит $a$ или $b$.
 \end{theorem}
\begin{proof}
	Пусть $ord$ - порядок некоторой перестановки $\rho \in S_k$. Если $ord \le k$, теорема доказана в силу Лемм \ref{2blocks div 2} - \ref{2blocks div k}.
	
	Пусть $\rho$ состоит из двух циклов длин $c_1$, $c_2$, и предположим, что ни $a$, ни $b$ не делится на $\lcm(c_1, c_2)$. Значит, без ограничения общности, $c_1 | a$ и $c_2 | b$ и соответственно $c_1 \not | b$ и $c_2 \not | a$. 
	\scalingimage{2_cycles}{0.5}{}
	Рассмотрим автомат над алфавитом $\{xy, yx\}$ с начальным состоянием 0, обе перестановки которого состоят из двух циклов длин $c_1$ и $c_2$, начальное состояние находится в цикле длины $c_1$, и соответствующие циклы обеих перестановок состоят из одних и тех же состояний, за исключением одного (см. Рисунок \ref{fig:2_cycles}). Пусть в перестановке $yx$ в состоянии с номером $b mod c_1$ находится вершина $s$.
	
	Тогда, при чтении слова $(xy)^a(yx)^b$ автомат сначала вернется в состояние 0, потому что $c_1 | a$, а затем остановится в состоянии $s$. А при чтении $(yx)^b(xy)^a$ автомат сначала окажется в состоянии $s$ цикла длины $c_1$, а затем придет в некоторое состояние $v \ne s$ цикла $c_2$ перестановки $xy$, поскольку $c_2 \not | a$. То есть данный автомат различит рассматриваемую пару слов, что приводит к противоречию.
	
	Теперь описанные ранее случаи представим как базу индукции по наименьшему числу "циклов" $n$, на которые можно разбить перестановку $\rho$.
	Предположим, что для всех  $n < m$ теорема доказана. Докажем для $n=m$. Пусть порядок $\rho$ есть $\lcm(c_1, c_2, ..., c_n)$. По предположению индукции НОК любых $n-1$-их длин циклов делит $a$ или $b$. Поскольку таких $n-1$-наборов больше чем 2, хотя бы на одно из этих чисел придется хотя бы 2 набора. Без ограничения общности пусть $\lcm(c_1, c_2, ..., c_{n-1}) | a$ и $\lcm(c_2, c_3, ..., c_n) | a$. Но тогда $a$ делится на $\lcm(c_1, c_2, ..., c_n)$. Теорема доказана. 
\end{proof} 

\newpage
\subsection{Тождества из трех блоков}

		$(xy)^a(yx)^b(xy)^c$ = $(yx)^c(xy)^b(yx)^a$ является тождеством в $S_k$, если для каждого $z$ - порядка $k$-перестановки выполняется хотя бы одно из следующих правил:
	\begin{equation} \label{3blocks 1st cond}
	z|a \hspace{10pt} \text{и} \hspace{10pt} z|(b-c)
	\end{equation}
	\begin{equation}
	z|c \hspace{10pt} \text{и} \hspace{10pt} z|(b-a)
	\end{equation}
	\begin{equation} \label{3blocks 3rd cond}
	z|b \hspace{10pt} \text{и} \hspace{10pt} z|(a+c)
	\end{equation}
	
	\begin{definition}
		Циклической перестановкой из $k$ элементов с шагом $s$ будем называть такую циклическую перестановку, в которой элемент с номером $i$ переходит в элемент с номером $i+s \hspace{5pt} (\mod k)$. 
	\end{definition}
	
	Далее будем считать, что элементы перестановки длины $k$ - это числа от $0$ до $k-1$.
	
	\begin{comment}
	\begin{lemma} \label{existence_of_clockwise_and_vv}
	Существуют такие перестановки $x$ и $y$ из $S_k$, что $xy$ - циклическая перестановка с шагом -1, а $yx$ - циклическая перестановка с шагом 1.
	\end{lemma}
	\begin{proof}
	Рассмотрим перестановку $x$: $i \rightarrow -i (\mod k)$ и $y$: $i \rightarrow -i+1 (\mod k)$.
	$$
	x = 
	\begin{pmatrix}
	0&1&2&3&...&k-3&k-2&k-1\\
	0&k-1&k-2&k-3&...&3&2&1
	\end{pmatrix}
	$$
	
	$$
	y = 
	\begin{pmatrix}
	0&1&2&3&...&k-3&k-2&k-1\\
	1&0&k-1&k-2&...&4&3&2
	\end{pmatrix}
	$$
	
	Тогда 
	
	$xy$: $i \xrightarrow y (-i+1) \xrightarrow x (-(-i+1)) == i-1$,
	
	$yx$: $i \xrightarrow x (-i) \xrightarrow y (-(-i)+1) == i+1$
	
	\end{proof}
	\end{comment}
	
	\begin{lemma} \label{a-b+c is 0 for odd}
		Пусть $(xy)^a(yx)^b(xy)^c$ = $(yx)^c(xy)^b(yx)^a$ - тождество в $S_k$, где $k$ - нечетное. Тогда $a - b + c \equiv 0 \hspace{5pt} (\mod k)$.
	\end{lemma}
	\begin{proof}
		Зафиксируем перестановки $xy$ и $yx$ %из Леммы \ref{existence_of_clockwise_and_vv}.
		такие, что $xy$ - циклическая перестановка с шагом -1, а $yx$ - циклическая перестановка с шагом 1.
		Рассмотрим перестановочный автомат, в котором переход по символам осуществляется соответствующими перестановками $x$ и $y$. Тогда, чтобы $(xy)^a(yx)^b(xy)^c$ = $(yx)^c(xy)^b(yx)^a$ было тождеством для такого автомата, требуется, чтобы автомат закончил читать обе части равенства в одном состоянии, то есть	
		\begin{equation}
		(-a) + b + (-c) \equiv c + (-b) + a \hspace{5pt} (\mod k)
		\end{equation}
		что эквивалентно 
		\begin{equation}
		2(a - b + c) \equiv 0 \hspace{5pt} (\mod k)
		\end{equation}
		Из того, что $k$ нечетно, следует 
		$$
		(a - b + c) \equiv 0 \hspace{5pt} (\mod k)
		$$.
	\end{proof}
	
	\begin{lemma} \label{a-b+c is 0 for even}
		Пусть $(xy)^a(yx)^b(xy)^c$ = $(yx)^c(xy)^b(yx)^a$ - тождество в $S_k$, где $k$ - четное. Тогда $a - b + c \equiv 0 \hspace{5pt} (\mod \frac{k}{2})$.
	\end{lemma}
	\begin{proof}
		Рассмотрим перестановочный автомат, как в доказательстве Леммы \ref{a-b+c is 0 for odd}. Аналогично, получим	
		\begin{equation}
		2(a - b + c) \equiv 0 \hspace{5pt} (\mod k)
		\end{equation}
		Из того, что $k$ четно, следует 
		$$
		(a - b + c) \equiv 0 \hspace{5pt} (\mod \frac{k}{2})
		$$.
	\end{proof}
	
	\begin{corollary} \label{a-b+c is 0 mod lcm/2}
		Пусть $(xy)^a(yx)^b(xy)^c$ = $(yx)^c(xy)^b(yx)^a$ - тождество в $S_k$. Тогда $a - b + c \equiv 0 \hspace{5pt} (\mod \frac{\lcm(k)}{2})$.
	\end{corollary}
	\begin{proof}
		Из Леммы \ref{a-b+c is 0 for odd} $a - b + c \equiv 0$ по модулю наименьшего общего кратного всех нечетных чисел, меньших $k$.
		По Лемме \ref{a-b+c is 0 for even} $a - b + c \equiv 0$ по модулю предмаксимальной степени числа 2, не превосходящей $k$.
		Отсюда следует, что $a - b + c \equiv 0 \hspace{5pt} (\mod \frac{\lcm(k)}{2})$.
	\end{proof}
	
	\begin{theorem}\label{b is a plus c}
		Пусть $(xy)^a(yx)^b(xy)^c$ = $(yx)^c(xy)^b(yx)^a$ - тождество в $S_k$ и $a + b + c \le \frac{\lcm(k)}{2}$. Тогда $b = a+c$.
	\end{theorem}
	\begin{proof}
		Сразу заметим, что ни одно из чисел $a$, $b$, $c$ не равно 0, так как в противном случае мы будем рассматривать тождество другого типа.
		
		Из Следствия \ref{a-b+c is 0 mod lcm/2} вытекает, что \hspace{5pt} 
		$$
		b - a - c = \frac{\lcm(k)}{2}m,
		$$ где $m \in \mathbb{Z}$. 
		Откуда
		$$
		b = a + c + \frac{\lcm(k)}{2}m > 0.
		$$
		Получим цепочку неравенств 
		$$
		0 < a + c + \frac{\lcm(k)}{2}m < \frac{\lcm(k)}{2} + \frac{\lcm(k)}{2}m = \frac{\lcm(k)}{2}(m + 1),
		$$то есть $m > -1$.
		
		С другой стороны, подставим $b$ в $a+b+c$, получим
		$$
		2(a + c) + \frac{\lcm(k)}{2}m \le \frac{\lcm(k)}{2}
		$$ или 
		$$
		2(a + c) \le \frac{\lcm(k)}{2}(1-m)
		$$
		Поскольку сумма $a$ и $c$ должна быть положительным числом, требуется
		$$
		\frac{\lcm(k)}{2}(1-m) > 0,
		$$ то есть $m < 1$.
		
		Значит, при заданных ограничениях $m = 0$, что влечет $b = a + c$.
	\end{proof}
	
	\begin{corollary}
		Для кратчайшего тождества вида $(xy)^a(yx)^b(xy)^c$ = $(yx)^c(xy)^b(yx)^a$ выполняется $b = a + c$.
	\end{corollary}
	\begin{proof}
		Достаточно показать, что существуют тождества, для которых $a + b + c \le \frac{\lcm(k)}{4}$ (тогда кратчайшее тождество также удовлетворяет этому условию, а по теореме для всех тождеств с таким свойством выполняется $b = a + c$).
		
		Пусть $m = 2k/3$, $a := lcm(m)$, $c := lcm(k - m) \cdot P(m)$, $b := a+c$, где $P(m)$ - произведение всех простых и степеней простых чисел из множества $\{m+1, ..., k\}$. $a$ и $c$ взяты из доказательства длины тождества из двух блоков. Оттуда же понятно, что любой порядок перестановки делит или $a$, или $c$, а, благодаря выбору $b$, делит и соответствующую разность. Длина такого тождества, конечно, в два раза больше длины тождества из двух блоков ($e^{\frac{2}{3}k + O(\frac{k}{\log k})}$), однако все равно асимптотически меньше, чем $\frac{\lcm(k)}{4}$ (который  равен $e^{k + O(\frac{k}{\log k})}$).
	\end{proof}
	
	Теперь, вооружившись утверждением о связи показателей степеней рассматриваемого тождества, можно доказать обратное утверждение, т.е. если $(xy)^a(yx)^b(xy)^c$ $\equiv_k$ $(yx)^c(xy)^b(yx)^a$, то выполняется хотя бы одно из условий \ref{3blocks 1st cond} - \ref{3blocks 3rd cond}. Для этого нам понадобится доказать еще несколько лемм.
	Однако заметим сразу, что равенство $b = a + c$ делает истинной вторые части утверждений \ref{3blocks 1st cond} - \ref{3blocks 3rd cond}, если первые истинны.
	
	\begin{lemma}\label{abc div 2}
		Если $(xy)^a(yx)^b(xy)^c$ $\equiv_k$ $(yx)^c(xy)^b(yx)^a$, тогда хотя бы одно из чисел $a$, $b$, $c$ делится на 2.
	\end{lemma}
	\begin{proof}
		От противного. Пусть $a$, $b$, $c$ нечетны. Тогда $b \ne a+c$, поскольку их четность не совпадает. Противоречие.
	\end{proof}
	
	\begin{lemma}\label{abc div 3}
		Если $(xy)^a(yx)^b(xy)^c$ $\equiv_k$ $(yx)^c(xy)^b(yx)^a$ и $k \ge 4$, тогда хотя бы одно из чисел $a$, $b$, $c$ делится на 3.
	\end{lemma}
	\begin{proof}
		От противного. Пусть ни одно из чисел $a$, $b$, $c$ не делится на 3. Тогда возможны лишь два варианта:
		\begin{enumerate}
			\item $a \equiv_3 c \equiv_3 1$ и $b \equiv_3 2$
			\item $a \equiv_3 c \equiv_3 2$ и $b \equiv_3 1$
		\end{enumerate}
		
		(В остальных случаях хотя бы одно из чисел оказывается кратным трем)
		
		Рассмотрим автомат относительно символов $xy$, $yx$ на рисунке \ref{fig:3division}. Такой автомат можно получить, взяв за перестановку по $x$ $(0)(1,2,3)$, по $y$ - $(1)(3, 2, 0)$. Начальное состояние 0.
		
		В первом случае автомат закончит читать левую часть тождества в состоянии 3 (после прочтения $(xy)^a$ окажется в состоянии 1, затем, прочитав $(yx)^b$ придет в состояние 3 в цикле), а правую - в состоянии 1 (после прочтения $(yx)^c$ окажется в состоянии 3 и в нем останется после $(xy)^b$).
		
		\scalingimage{3division}{0.5}{}
		
		Во втором случае автомат закончит читать левую часть тождества в состоянии 1 (после прочтения $(xy)^a$ окажется в состоянии 2, затем, прочитав $(yx)^b$ останется в состоянии 2), а правую - в состоянии 2 (после прочтения $(yx)^c$ окажется в состоянии 1 и перейдет в состояние 2 после $(xy)^b$).
		
		Получили противоречие с тем, что данная пара - тождество.
	\end{proof}
	
	\begin{lemma}\label{abc div k}
		Если $(xy)^a(yx)^b(xy)^c$ $\equiv_k$ $(yx)^c(xy)^b(yx)^a$ и $k \ge 4$, тогда хотя бы одно из чисел $a$, $b$, $c$ делится на $k$.
	\end{lemma}
	\begin{proof}
		От противного. Пусть ни одно из чисел $a$, $b$, $c$ не делится на $k$. Разберем несколько случаев.
		\begin{enumerate}
			\item $2a \equiv_k 0$.
			\scalingimage{cycle_a_c}{0.5}{Цикл $xy$ автомата $\mathscr{A}$}
			
			Поскольку мы предположили, что $a \not \equiv_k 0$, значит $a \equiv_k \frac{k}{2}$. Так как $a+c=b$, $b \not \equiv_k 0$ по предположению, то $c \not \equiv_k a$.
			
			\scalingimage{process1_a_c}{0.5}{Чтение слова $(xy)^a(yx)^b(xy)^c$ автоматом $\mathscr{A}$}
			\scalingimage{process2_a_c}{0.5}{Чтение слова $(yx)^c(xy)^b(yx)^a$ автоматом $\mathscr{A}$}
			
			Рассмотрим автомат $\mathscr{A}$, в котором $xy$ - перестановка с шагом 1, в которой поменяли местами $a$ и $c$, а $yx$ - перестановка с шагом -1 (см. Рисунок \ref{fig:cycle_a_c}). Данный автомат различит слова $(xy)^a(yx)^b(xy)^c$ и $(yx)^c(xy)^b(yx)^a$. 
			
			$\mathscr{A}$ закончит читать второе слово в состоянии $c-a$ (см. Рисунок \ref{fig:process2_a_c}).
			Корректность переходов:
			\begin{itemize}
				\item $-c \not \equiv_k a$ и $-c \not \equiv_k c$ поскольку иначе в обоих случаях он был бы равен $\frac{k}{2}$ и совпадал бы с $a$;
				\item $b-c = a$ из Теоремы \ref{b is a plus c}.
			\end{itemize}
			
			$\mathscr{A}$ закончит читать второе слово в состоянии с номером $2c$ (см. Рисунок \ref{fig:process2_a_c}).
			Корректность переходов:
			\begin{itemize}
				\item $c-b \equiv_k -a$ из Теоремы \ref{b is a plus c}, а $a \equiv_k -a$ поскольку $a \equiv_k \frac{k}{2}$;
				\item $2c \not \equiv_k c$ поскольку по предположению $c \not \equiv_k 0$.
			\end{itemize}
			Конечное состояние при чтении $(yx)^c(xy)^b(yx)^a$ зависит от того, совпадает ли $2c$ с $a$ по модулю $k$:
			\begin{itemize}
				\item $2c \equiv_k a$, тогда состоянием с номером $2c$ будет состояние $c$, которое не совпадает с $c-a$, поскольку $-a$ не сравнимо с нулем по модулю $k$;
				\item $2c \not \equiv_k a$, тогда конечным состоянием будет $2c$, которое не совпадает с $c-a$, поскольку $a+c \not \equiv_k 0$.
			\end{itemize}
			
			\item $2a \not \equiv_k 0$ и $2a \not \equiv_k -c$
			\scalingimage{cycle_a_2a}{0.5}{Цикл $yx$ автомата $\mathscr{B}$}
			\scalingimage{process1_a_2a}{0.5}{Чтение слова $(xy)^a(yx)^b(xy)^c$ автоматом $\mathscr{B}$}
			\scalingimage{process2_a_2a}{0.5}{Чтение слова $(yx)^c(xy)^b(yx)^a$ автоматом $\mathscr{B}$}
			
			Рассмотрим автомат $\mathscr{B}$, в котором $xy$ - перестановка с шагом 1, а $yx$ - перестановка с шагом -1, в которой поменяли местами $a$ и $2a$ (см. Рисунок \ref{fig:cycle_a_2a}). Данный автомат различит слова $(xy)^a(yx)^b(xy)^c$ и $(yx)^c(xy)^b(yx)^a$.
			
			$\mathscr{B}$ закончит читать $(xy)^a(yx)^b(xy)^c$ в состоянии $a$ (см. Рисунок \ref{fig:process1_a_2a}).
			Корректность переходов:
			\begin{itemize}
				\item $2a-b = a-c$ по Теореме \ref{b is a plus c}, $a-c \not \equiv_k a$, так как $-c \not \equiv_k 0$ по предположению, и $a-c \not \equiv_k 2a$, так как $a+c \not \equiv_k 0$ также по предположению.
			\end{itemize}
			
			$\mathscr{B}$ закончит читать $(yx)^c(xy)^b(yx)^a$ в состоянии $2a$ (см. Рисунок \ref{fig:process2_a_2a}).
			Корректность переходов:
			\begin{itemize}
				\item $-c \not \equiv_k a$, поскольку $a+c \not \equiv_k 0$ по предположению, и $-c \not \equiv_k 2a$ по заданному ограничению;
				\item $b-a = c$ по Теореме \ref{b is a plus c}.
			\end{itemize}
			Состояния $a$ и $2a$ не совпадают, так как $a \not \equiv_k 0$ по предположению.
			
			\item $2a \not \equiv_k 0$ и $2a \equiv_k -c$ и $3a \not \equiv_k 0$
			\scalingimage{process2_a_2a_-c_is_2a}{0.5}{Чтение слова $(yx)^c(xy)^b(yx)^a$ автоматом $\mathscr{B}$ в случае, когда $2a \equiv_k -c$}
			
			Рассмотрим автомат $\mathscr{B}$ из предыдущего случая (см. Рисунок \ref{fig:cycle_a_2a}). В этом случае этот автомат также разделит рассматриваемую пару слов.
			
			Чтение слова $(xy)^a(yx)^b(xy)^c$ будет абсолютно таким же, как и в предыдущем случае.
			Чтение слова $(yx)^c(xy)^b(yx)^a$ закончится в состоянии $-a$ (см. Рисунок \ref{fig:process2_a_2a_-c_is_2a}).
			Корректность переходов:
			\begin{itemize}
				\item $2a \equiv_k -c$ по заданному ограничению;
				\item $a+b \equiv_k 0$ поскольку $a+b = 2a+c \equiv_k 2a - 2a = 0$ по Теореме \ref{b is a plus c} и заданному ограничению;
				\item $-a \not equiv_k a$, так как $2a \not \equiv_k 0$, и $-a \not equiv_k a$, поскольку $3a \not \equiv_k 0$ по заданному ограничению.
			\end{itemize}
			Состояния $a$ и $-a$ также не совпадают.
			
			\item $2a \not \equiv_k 0$ и $2a \equiv_k -c$ и $3a \equiv_k 0$
			
			Поскольку $3a \equiv_k 0$, то $a \equiv_k \frac{k}{3}$ или $a \equiv_k \frac{2k}{3}$, а из того, что $2a+c \equiv_k 0$ следует, что $a \equiv_k c$.
			
			\scalingimage{cycle_2m_z}{0.5}{Цикл $yx$ автомата $\mathscr{C}$}
			
			Пусть $k = 3m$, $m \in \mathbb{N}$.
			Рассмотрим перестановочный автомат $\mathscr{C}$ такой, что $xy$ - циклическая перестановка из $k$ элементов с шагом 1, а $yx$ - циклическая перестановка из $k$ элементов с шагом 1, в которой поменяли местами состояния $2m$ и $z$, где $z \not \equiv 0 (\mod k)$, $z \not \equiv m (\mod k)$ и $z \not \equiv 2m (\mod k)$ (см. Рис. \ref{fig:cycle_2m_z}). Такое $z$ существует, если $k > 3$.
			
			Покажем, что автомат $\mathscr{C}$ закончит читать слова $(xy)^a(yx)^b(xy)^c$ и $(yx)^c(xy)^b(yx)^a$ в разных состояниях.
			
			\begin{enumerate}
				\item $a \equiv_k c \equiv_k m$, $b \equiv_k 2m$
				
				Начальным состоянием в автомате $\mathscr{C}$ назначим состояние $m$.
				\scalingimage{process1_2m_z}{0.5}{Чтение слова $(xy)^a(yx)^b(xy)^c$ автоматом $\mathscr{C}$ при $a \equiv_k \frac{k}{3}$}
				\scalingimage{process2_2m_z}{0.5}{Чтение слова $(yx)^c(xy)^b(yx)^a$ автоматом $\mathscr{C}$ при $a \equiv_k \frac{k}{3}$}
				
				$\mathscr{C}$ закончит читать $(xy)^a(yx)^b(xy)^c$ в состоянии $z$ (см. Рисунок \ref{fig:process1_2m_z}), а слово $(yx)^c(xy)^b(yx)^a$ - в состоянии $2m$ (см. Рисунок \ref{fig:process2_2m_z}).
				
				Корректность переходов:
				\begin{itemize}
					\item $z + 2m \not \equiv_k z$, так как $2m = \equiv_k 2a \not \equiv_k 0$ по заданному ограничению;
					\item $z + 2m \not \equiv_k 2m$, так как $z \not \equiv_k 0$ по выбору $z$.
				\end{itemize}
				Состояние $z$ не совпадает с $2m$ по выбору $z$.
				
				\item $a \equiv_k c \equiv_k 2m$, $b \equiv_k m$
				
				Начальным состоянием в автомате $\mathscr{C}$ назначим состояние $0$.
				\scalingimage{process1_2m_z_init_0}{0.5}{Чтение слова $(xy)^a(yx)^b(xy)^c$ автоматом $\mathscr{C}$ при $a \equiv_k \frac{2k}{3}$}
				\scalingimage{process2_2m_z_init_0}{0.5}{Чтение слова $(yx)^c(xy)^b(yx)^a$ автоматом $\mathscr{C}$ при $a \equiv_k \frac{2k}{3}$}
				
				$\mathscr{C}$ закончит читать $(xy)^a(yx)^b(xy)^c$ в состоянии $z$ (см. Рисунок \ref{fig:process1_2m_z_init_0}), а слово $(yx)^c(xy)^b(yx)^a$ - в состоянии $2m$ (см. Рисунок \ref{fig:process2_2m_z_init_0}).
				
				Корректность переходов:
				\begin{itemize}
					\item $z + m \not \equiv_k z$, так как $m = \equiv_k 2a \not \equiv_k 0$ по заданному ограничению;
					\item $z + m \not \equiv_k m$, так как $z \not \equiv_k 0$ по выбору $z$.
				\end{itemize}
				
				Состояние $z$ не совпадает с $2m$ по выбору $z$.
			\end{enumerate}
		\end{enumerate}
		
		Рассмотрены все возможные случаи, и для каждого из них приведен автомат, разделяющий пару слов, которая по условию была тождеством. Значит, наше предположение о том, что ни одно из чисел $a$, $b$, $c$ не делится на $k$, было ложным.
	\end{proof}
	
	\begin{theorem}
		Если $(xy)^a(yx)^b(xy)^c$ $\equiv_k$ $(yx)^c(xy)^b(yx)^a$ и $k \ge 4$, то для любого порядка $ord$ перестановки из $k$ элементов хотя бы одно из чисел $a$, $b$, $c$ делится на $ord$.
	\end{theorem}
	\begin{proof}
		Если перестановка представима в виде одного цикла (здесь опускаются тривиальные циклы из одного состояния), значит порядок перестановки $ord$ меньше либо равен $k$, и утверждение доказано Леммами \ref{abc div 2} - \ref{abc div k}.
		
		Пусть k-перестановка представима в виде произведения двух циклов с длинами $c_1$ $c_2$. Тогда порядок перестановки равен $lcm(c_1, c_2)$. От противного, предположим, что ни одно из чисел $a$, $b$, $c$ не делится на $lcm(c_1, c_2)$. Рассмотрим несколько вариантов.
		\scalingimage{2_cycles}{0.5}{Автомат $\mathscr{A}$}
		
		\begin{enumerate}
			\item $c_1 | a$ и $c_2 | b$.
			
			Тогда $c_1 \not | c$ и $c_2 \not | c$, поскольку иначе разность $b-c$ делилась бы на $c_1$ или $c_2$ соответственно, а это повлекло бы за собой или $c_2 | a$, или $c_1 | b$. Также, исходя из Теоремы \ref{b is a plus c}, $c_1 | (b-c)$, откуда $b \equiv_{c_1} c$.
			
			Рассмотрим автомат $\mathscr{A}$ c переходами по $xy$ и $yx$, изображенный на рисунке \ref{fig:2_cycles}. Начальное состояние автомата - $0$; циклы, длинами $c_1$ и $c_2$, у разных перестановок отличаются только одним состоянием (состояние $s$ у перестановки $xy$ располагается в цикле $c_2$, а у перестановки $yx$ - в цикле $c_1$; аналогичная ситуация с состоянием $t$), остальные вершины у циклов с одинаковыми длинами совпадают. Покажем, что данный автомат различит строки $(xy)^a(yx)^b(xy)^c$ и $(yx)^c(xy)^b(yx)^a$.
			
			\begin{itemize}
				\item Читаем $(xy)^a(yx)^b(xy)^c$
				
				$0.(xy)^a = 0$, так как $c_1 | a$. $0.(yx)^b = s$ по выбору вершины $s$, и автомат переходит к циклу $c_2$. $s.(xy)^c = w$, где $w$ - вершина цикла длины $c_1$ перестановки $xy$, не совпадающая с $s$, поскольку $c_1 \not | c$. 
				
				\item Читаем $(yx)^c(xy)^b(yx)^a$
				
				$0.(yx)^c = s$, так как $b \equiv_{c_1} c$; автомат переходит к циклу $c_2$. $s.(xy)^b = s$ поскольку $c_2 | b$;  автомат переходит к циклу $c_1$. $s.(yx)^a = s$, поскольку $c_1 | a$.
			\end{itemize}
			Поскольку $w \ne s$, автомат различит слова, что противоречит тождественности пары.
			
			\item $c_1 | a$ и $c_2 | с$.
			
			Рассуждая аналогично предыдущему случаю, получим, что $b \equiv_{c_1} c$, $c_1 \not | b$, $c_2 \not | b$.
			
			Рассмотрим автомат $\mathscr{A}$ из предыдущего случая, и покажем, что он и здесь различит рассматриваемую пару слов.		
			\begin{itemize}
				\item Читаем $(xy)^a(yx)^b(xy)^c$
				
				$0.(xy)^a = 0$, так как $c_1 | a$. $0.(yx)^b = s$ по выбору вершины $s$; автомат переходит к циклу $c_2$. $s.(xy)^c = s$, поскольку $c_2 | c$. 
				
				\item Читаем $(yx)^c(xy)^b(yx)^a$
				
				$0.(yx)^c = s$, так как $b \equiv_{c_1} c$; автомат переходит к циклу $c_2$. $s.(xy)^b = v$, где $v$ - вершина цикла длины $c_2$ перестановки $xy$, не совпадающая с $s$, поскольку $c_2 \not | b$. $v.(yx)^a = v$, поскольку $c_1 | a$.
			\end{itemize}
			Так как $v$ и $s$ не совпадают, также приходим к противоречию.
			
			\item Случай $c_1 | c$ и $c_2 | b$ симметричен первому, поэтому можно построить аналогичный автомат. Остальные случаи аналогичны рассмотренным с точностью до смены длин циклов местами.
		\end{enumerate}
		
		Получается, что для любой перестановки, представляемой в виде объединения двух циклов, хотя бы одно из чисел $a$, $b$, $c$ делится на наименьшее общее кратное их длин (то есть, делится на обе длины одновременно).
		
		Предположим теперь, что k-перестановка представима в виде объединения трех циклов с длинами $c_1$, $c_2$, $c_3$. Для каждой пары циклов, как мы уже доказали, наименьшее общее кратное их длин делит хотя бы одно из чисел $a$, $b$, $c$. Всего таких пар в этом случае три. В зависимости их распределениям по числам $a$, $b$, $c$, можно также рассмотреть несколько случаев.
		
		\begin{enumerate}
			\item Все три НОК-а делят один показатель. Тогда этот показатель делится и на $\lcm(c_1, c_2, c_3)$;
			\item Два из трех НОК-ов делят один показатель. Без ограничения общности, $\lcm(c_1, c_2) | a$ и $\lcm(c_1, c_3) | a$. Тогда очевидно $\lcm(c_1, c_2, c_3) | a$;
			\item На каждый из показателей приходится по одной паре. Без ограничения общности, $\lcm(c_1, c_2) | a$ и $\lcm(c_1, c_3) | b$, $\lcm(c_2, c_3) | c$. Поскольку, $c_1 | a$ и $c_1 | b$, $c_1 | (b-a)$, а по Теореме \ref{b is a plus c} $b-a = c$, значит и $c_1 | c$. Получается, что $c$ делится на все три длины циклов, а значит делится на их НОК. 
		\end{enumerate}
		Значит, для порядков, соответствующие которым перестановки разбиваются на три цикла, теорема тоже доказана.
		
		Теперь описанные ранее случаи представим как базу индукции по наименьшему числу "циклов" $n$, на которые можно разбить порядок (то есть соответствующую ему перестановку).
		Предположим, что для всех  $n < m$ теорема доказана. Докажем для $n=m$. Пусть некоторый порядок есть $\lcm(c_1, c_2, ..., c_n)$. По предположению индукции НОК любых $n-1$-их длин циклов делит хотя бы одно из чисел $a$, $b$, $c$. Поскольку таких $n-1$-наборов больше чем 3, хотя бы на одно из этих чисел придется хотя бы 2 набора. Без ограничения общности пусть $\lcm(c_1, c_2, ..., c_{n-1}) | a$ и $\lcm(c_2, c_3, ..., c_n) | a$. Но тогда $a$ делится на $\lcm(c_1, c_2, ..., c_n)$. Теорема доказана.
	\end{proof}

\subsection{Тождества из четырех и более блоков}

\newpage
\section{Заключение}